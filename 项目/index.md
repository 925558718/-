
# Swiper方案调研
组件设计就是几个点吧，通用性，易用性，性能
## 通用性
是否可拖动
是否可从最后一个返回第一个
是否可支持自定义
是否支持自定义指示器
是否显示指示器
支持上下左右滑动
控制间隔速度，控制动画速度
是否能自动播放
是否循环
滚动事件
## 易用性
尽量减少配置，有需要在开启
Antd的话需要两个组件，一个是swiper，一个swiper-item，swiperitem里面在去写业务代码。
我的swiper只需要一个组件，最基本的功能只需要传入一个height，里面就是直接写div，组件会为这些div赋予基本的样式，如果用户想自己写样式，也可以给加类名。如果用户想改变指示器，可以在内部写一个特点class的结点，然后就能自己写了

## 性能

用requestAnimationFrame来保证顺滑度
用useVisible 让只在页面展现的时候才会自动播放，返回页面后重新播放
利用usememo减少渲染次数

### 实现方案

#### 如何让组件马上渲染两次


# 红包雨
## 项目介绍
业务春节期间的campagin，每天大约有11万人参与。开发是我和一个实习生，我负责owner项目和关键的红包雨游戏部分
### 项目流程
活动分为未开始，已开始，红包雨，已结束 4个阶段
用户通过主产品点击banner为进入到活动页面，进入页面请求一次后端接口，然后根据后端返回的时间戳，有无下轮做逻辑渲染
未开始的时候可以预约，然后用户下次到了时间进来就可以玩游戏了
游戏就是从上方掉红包，用户可以点点点，游戏时长为15秒，游戏结束后把点击数量上传给后端，后端进行抽奖
请求抽奖接口呢会弹弹窗提示用户是否中奖，关闭弹窗重新拉去首页接口，此时活动变为已结束，如果有下一轮的话会回到1阶段开始一个循环。
## 整体代码构造
整体代码构造就是两个页面，就是首页是一个page，计时组件，然后是游戏组件，游戏组件又分为Manager类，Spirit抽象类（下面有粒子对象，红包对象），资源加载类，游戏设置类,manager就是一直调用requestAnimationFrame，去生成销毁check对象

## 遇到的问题

### 前端开始时间不准确
因为setInterval有轻微的不准确,每次执行可能有4ms的延迟，如果用户一直等待倒计时的话最终会有十来秒的延迟，如果一直请求后端接口的话也会给后端造成不小的压力，所以我弄了一个前端校验倒计时这样的一个工具，比如说第一次执行在1004ms,所以下次执行应该在996ms后执行，第三次在1004ms，那么第四次就在992ms后执行。实现呢就是在开始的时候记录一下客户端时间，这是一个相对时间，每执行一次加1000，然后根据1000做diff判断。
### 交互
这里后端本来是准备点一下就要掉一下他们的接口，因为后端希望能把抽奖逻辑完全掌握在他们那边，然后我感觉这样会非常影响交互，因为交互上点中有奖或没奖的红包动画不一样，而一个接口响应时间又最低也要100ms，这点其实非常影响用户的使用，然后我跟后端leader battle，他们也没啥更好的办法就同意改为最后上传点中数量，这样的话这个游戏其实就是一个纯前端控制的，交互上还是从代码复杂度上都更优吧。
### 资源加载
把所有的资源都放到内存map里，键名为文件名，为什么要写这个资源加载呢，因为对象的绘制是用drawImage这个api，他接受一个image对象，如果每个对象都要一个new一个image内存就上来了，所以资源管理的工具，并且canvas有一个特性是默认用的低反走样是low，就是锯齿明显，可以设置imageSmoothingQuality来提高，但是如果在资源未加载完毕下设置是没有效果的所以也需要这样一个东西


# 前端监控报警系统
## 整体设计
## 细节